## π“‹ κ°μ”

μ΄ ν”„λ΅μ νΈλ” FastMCP λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ λ™κΈ°(synchronous)μ™€ λΉ„λ™κΈ°(asynchronous) λ„κµ¬μ μ„±λ¥ μ°¨μ΄λ¥Ό μ‹¤μµν•κ³  λΉ„κµν•  μ μλ” μμ μ…λ‹λ‹¤. CPU μ§‘μ•½μ μΈ μ‘μ—…μ„ λ™κΈ°μ™€ λΉ„λ™κΈ° λ°©μ‹μΌλ΅ κ°κ° κµ¬ν„ν•κ³ , λ‹¤μ¤‘ ν΄λΌμ΄μ–ΈνΈ ν™κ²½μ—μ„μ μ„±λ¥ μ°¨μ΄λ¥Ό μΈ΅μ •ν•μ—¬ λΉ„λ™κΈ° ν”„λ΅κ·Έλλ°μ μ¤‘μ”μ„±μ„ ν•™μµν•  μ μμµλ‹λ‹¤.

μ£Όμ” κΈ°μ  μ¤νƒμΌλ΅λ” FastMCP, anyio, asyncioλ¥Ό ν™μ©ν•λ©°, MCP μ„λ²„μ—μ„ λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬λ¥Ό μ κ³µν•κ³  ν΄λΌμ΄μ–ΈνΈμ—μ„ λ™μ‹μ— μ—¬λ¬ μ”μ²­μ„ λ³΄λ‚΄μ–΄ μ„±λ¥μ„ λΉ„κµ λ¶„μ„ν•©λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ΄λ²¤νΈ λ£¨ν”„ λΈ”λ΅ν‚Ή ν„μƒκ³Ό `anyio.to_thread.run_sync()`λ¥Ό ν™μ©ν• λΈ”λ΅ν‚Ή λ°©μ§€ κΈ°λ²•μ„ μ‹¤μµν•  μ μμµλ‹λ‹¤.

> π”— **μƒμ„Έ μ½”λ“ λ° μμ **: [https://github.com/yeounhak/mcp-python-best-practice/02/01/03-Async-and-Synchronous-Tools][github-repo]

[github-repo]: https://github.com/yeounhak/mcp-python-best-practice/02/01/03-Async-and-Synchronous-Tools

## π“ νμΌ κµ¬μ„±

```
03-Async-and-Synchronous-Tools/
β”β”€β”€ server.py          # MCP μ„λ²„ κµ¬ν„ (λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬)
β””β”€β”€ client.py          # μ„±λ¥ λΉ„κµ ν…μ¤νΈ ν΄λΌμ΄μ–ΈνΈ
```

### μ£Όμ” νμΌ μ„¤λ…

**server.py**

**1. λ¨λ“ λ¬Έμ„ν™” λ° κΈ°λ³Έ μ„¤μ •**
```python
"""
MCP μ„λ²„: λ™κΈ° vs λΉ„λ™κΈ° λ„κµ¬ μμ 

μ΄ λ¨λ“μ€ λ™κΈ°μ™€ λΉ„λ™κΈ° μ‘μ—…μ μ°¨μ΄μ μ„ λ³΄μ—¬μ£Όλ” MCP μ„λ²„λ¥Ό κµ¬ν„ν•©λ‹λ‹¤.
λ™κΈ° λ„κµ¬λ” μ΄λ²¤νΈ λ£¨ν”„λ¥Ό λΈ”λ΅ν•λ” λ°λ©΄, λΉ„λ™κΈ° λ„κµ¬λ” μ¤λ λ“ ν’€μ„ μ‚¬μ©ν•μ—¬
μ΄λ²¤νΈ λ£¨ν”„ λΈ”λ΅ν‚Ήμ„ λ°©μ§€ν•©λ‹λ‹¤.
"""

import anyio
from fastmcp import FastMCP
from time import sleep

# μƒμ μ •μ
CPU_TASK_DURATION = 1  # CPU μ§‘μ•½μ  μ‘μ—… μ‹κ°„ (μ΄)

# FastMCP μΈμ¤ν„΄μ¤ μƒμ„±
mcp = FastMCP()
```
- λ¨λ“ λ λ²¨μ—μ„ μƒμ„Έν• λ¬Έμ„ν™”λ¥Ό μ κ³µν•μ—¬ μ½”λ“μ λ©μ κ³Ό λ™μ‘ λ°©μ‹μ„ λ…ν™•ν μ„¤λ…
- anyioλ¥Ό ν™μ©ν•μ—¬ λ™κΈ° ν•¨μλ¥Ό λΉ„λ™κΈ° μ¤λ λ“μ—μ„ μ‹¤ν–‰
- FastMCPλ¥Ό μ‚¬μ©ν•μ—¬ MCP μ„λ²„ μΈμ¤ν„΄μ¤ μƒμ„±
- μƒμλ΅ CPU_TASK_DURATIONμ„ μ •μν•μ—¬ μ‘μ—… μ‹κ°„μ„ 1μ΄λ΅ μ„¤μ •

**2. CPU μ§‘μ•½μ  μ‘μ—… ν•¨μ λ° λ™κΈ° λ„κµ¬**
```python
def _cpu_intensive_task() -> str:
    """
    CPU μ§‘μ•½μ μΈ μ‘μ—…μ„ μ‹λ®¬λ μ΄μ…ν•λ” ν—¬νΌ ν•¨μ
    
    Returns:
        str: μ‘μ—… μ™„λ£ λ©”μ‹μ§€
        
    Note:
        μ΄ ν•¨μλ” sleep()μ„ μ‚¬μ©ν•μ—¬ CPU μ§‘μ•½μ μΈ μ‘μ—…μ„ μ‹λ®¬λ μ΄μ…ν•©λ‹λ‹¤.
        μ‹¤μ  ν™κ²½μ—μ„λ” λ³µμ΅ν• κ³„μ‚°μ΄λ‚ λ°μ΄ν„° μ²λ¦¬ μ‘μ—…μ„ μλ―Έν•  μ μμµλ‹λ‹¤.
    """
    sleep(CPU_TASK_DURATION)
    return f"{CPU_TASK_DURATION}μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤."

@mcp.tool
def sync_tool() -> str:
    """
    λ™κΈ° λ°©μ‹ CPU μ§‘μ•½μ  μ‘μ—… λ„κµ¬
    
    Returns:
        str: μ‘μ—… μ™„λ£ λ©”μ‹μ§€
        
    Warning:
        μ΄ λ„κµ¬λ” λ™κΈ°μ μΌλ΅ μ‹¤ν–‰λμ–΄ μ΄λ²¤νΈ λ£¨ν”„λ¥Ό λΈ”λ΅ν•  μ μμµλ‹λ‹¤.
        λ‹¤λ¥Έ μ”μ²­λ“¤μ€ μ΄ μ‘μ—…μ΄ μ™„λ£λ  λ•κΉμ§€ λ€κΈ°ν•΄μ•Ό ν•©λ‹λ‹¤.
    """
    return _cpu_intensive_task()
```
- `_cpu_intensive_task()`λ” private ν•¨μλ΅ μ„¤κ³„λμ–΄ λ‚΄λ¶€ κµ¬ν„μ„ μΊ΅μν™”
- Google μ¤νƒ€μΌ docstringμΌλ΅ μƒμ„Έν• ν•¨μ λ¬Έμ„ν™” μ κ³µ
- `sync_tool()`μ€ λ™κΈ° λ°©μ‹μΌλ΅ μ‘μ—…μ„ μν–‰ν•λ―€λ΅ μ΄λ²¤νΈ λ£¨ν”„κ°€ λΈ”λ΅λ¨
- Warning μ„Ήμ…μΌλ΅ λΈ”λ΅ν‚Ή μ„ν—μ„±μ„ λ…μ‹μ μΌλ΅ κ²½κ³ 

**3. λΉ„λ™κΈ° λ„κµ¬ λ° μ„λ²„ μ‹¤ν–‰**
```python
@mcp.tool
async def async_tool() -> str:
    """
    λΉ„λ™κΈ° λ°©μ‹ CPU μ§‘μ•½μ  μ‘μ—… λ„κµ¬
    
    Returns:
        str: μ‘μ—… μ™„λ£ λ©”μ‹μ§€
        
    Note:
        anyio.to_thread.run_sync()λ¥Ό μ‚¬μ©ν•μ—¬ CPU μ§‘μ•½μ  μ‘μ—…μ„ λ³„λ„ μ¤λ λ“μ—μ„
        μ‹¤ν–‰ν•¨μΌλ΅μ¨ μ΄λ²¤νΈ λ£¨ν”„ λΈ”λ΅ν‚Ήμ„ λ°©μ§€ν•©λ‹λ‹¤.
        μ΄λ¥Ό ν†µν•΄ λ‹¤λ¥Έ μ”μ²­λ“¤μ΄ λ™μ‹μ— μ²λ¦¬λ  μ μμµλ‹λ‹¤.
    """
    return await anyio.to_thread.run_sync(_cpu_intensive_task)

def main() -> None:
    """
    MCP μ„λ²„ μ‹¤ν–‰ ν•¨μ
    
    HTTP μ „μ†΅μ„ μ‚¬μ©ν•μ—¬ λ¨λ“  λ„¤νΈμ›ν¬ μΈν„°νμ΄μ¤(0.0.0.0)μ
    ν¬νΈ 9000μ—μ„ μ„λ²„λ¥Ό μ‹μ‘ν•©λ‹λ‹¤.
    """
    mcp.run(
        transport="http",
        host="0.0.0.0",
        port=9000,
    )

if __name__ == "__main__":
    main()
```
- `async_tool()`μ— μƒμ„Έν• docstringμΌλ΅ λΉ„λ™κΈ° μ²λ¦¬ λ°©μ‹κ³Ό μ¥μ μ„ λ…ν™•ν μ„¤λ…
- `_cpu_intensive_task` ν•¨μ μ°Έμ΅°λ΅ μ—…λ°μ΄νΈλ ν•¨μλ… λ°μ
- `main()` ν•¨μλ¥Ό λ³„λ„λ΅ λ¶„λ¦¬ν•μ—¬ μ½”λ“ κµ¬μ΅° κ°μ„  λ° ν…μ¤νΈ μ©μ΄μ„± ν–¥μƒ
- λ¨λ“ μ‹¤ν–‰ μ‹ `main()` ν•¨μλ¥Ό νΈμ¶ν•λ” ν‘μ¤€ Python ν¨ν„΄ μ μ©

**client.py**

**1. λ™κΈ° λ„κµ¬ ν…μ¤νΈ ν΄λΌμ΄μ–ΈνΈ**
```python
import asyncio
import time
from fastmcp import Client

async def sync_client_task(client_id: int):
    """
    λ™κΈ° λ„κµ¬λ¥Ό νΈμ¶ν•λ” ν΄λΌμ΄μ–ΈνΈ μ‘μ—…
    """
    print(f"λ™κΈ° ν΄λΌμ΄μ–ΈνΈ {client_id}: μ‹μ‘")
    start_time = time.time()
    
    async with Client("http://0.0.0.0:9000/mcp") as client:
        result = await client.call_tool("sync_tool")
        end_time = time.time()
        elapsed = end_time - start_time
        print(f"λ™κΈ° ν΄λΌμ΄μ–ΈνΈ {client_id}: μ™„λ£ - μ†μ”μ‹κ°„: {elapsed:.2f}μ΄")
        print(f"λ™κΈ° ν΄λΌμ΄μ–ΈνΈ {client_id}: κ²°κ³Ό - {result}")
        return result
```
- κ° ν΄λΌμ΄μ–ΈνΈκ°€ λ™κΈ° λ„κµ¬(`sync_tool`)λ¥Ό νΈμ¶ν•μ—¬ μ„±λ¥ μΈ΅μ •
- `time.time()`μ„ ν™μ©ν•μ—¬ μ •ν™•ν• μ†μ”μ‹κ°„ κ³„μ‚°
- ν΄λΌμ΄μ–ΈνΈλ³„λ΅ μ‹μ‘/μ™„λ£ μ‹κ°„κ³Ό κ²°κ³Όλ¥Ό μ¶λ ¥ν•μ—¬ μ‹¤ν–‰ μμ„ ν™•μΈ

**2. λΉ„λ™κΈ° λ„κµ¬ ν…μ¤νΈ ν΄λΌμ΄μ–ΈνΈ**
```python
async def async_client_task(client_id: int):
    """
    λΉ„λ™κΈ° λ„κµ¬λ¥Ό νΈμ¶ν•λ” ν΄λΌμ΄μ–ΈνΈ μ‘μ—…
    """
    print(f"λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ {client_id}: μ‹μ‘")
    start_time = time.time()
    
    async with Client("http://0.0.0.0:9000/mcp") as client:
        result = await client.call_tool("async_tool")
        end_time = time.time()
        elapsed = end_time - start_time
        print(f"λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ {client_id}: μ™„λ£ - μ†μ”μ‹κ°„: {elapsed:.2f}μ΄")
        print(f"λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ {client_id}: κ²°κ³Ό - {result}")
        return result
```
- λ™μΌν• κµ¬μ΅°λ΅ λΉ„λ™κΈ° λ„κµ¬(`async_tool`)λ¥Ό νΈμ¶ν•μ—¬ μ„±λ¥ λΉ„κµ
- λ™κΈ° ν΄λΌμ΄μ–ΈνΈμ™€ λ™μΌν• μΈ΅μ • λ°©μ‹μΌλ΅ κ³µμ •ν• λΉ„κµ ν™κ²½ κµ¬μ„±

**3. λ©”μΈ μ„±λ¥ λΉ„κµ ν…μ¤νΈ ν•¨μ**
```python
async def main():
    """
    λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬ μ„±λ¥ λΉ„κµ ν…μ¤νΈ
    """
    print("λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬ μ„±λ¥ λΉ„κµ ν…μ¤νΈλ¥Ό μ‹μ‘ν•©λ‹λ‹¤...\n")
    
    # λ™κΈ° λ„κµ¬ ν…μ¤νΈ
    print("=" * 50)
    print("λ™κΈ° λ„κµ¬ ν…μ¤νΈ μ‹μ‘")
    print("=" * 50)
    
    sync_start = time.time()
    sync_tasks = [sync_client_task(i+1) for i in range(3)]
    sync_results = await asyncio.gather(*sync_tasks)
    sync_end = time.time()
    sync_elapsed = sync_end - sync_start
    
    print(f"\nλ™κΈ° λ„κµ¬ ν…μ¤νΈ μ™„λ£! μ΄ μ†μ”μ‹κ°„: {sync_elapsed:.2f}μ΄")
    
    # λΉ„λ™κΈ° λ„κµ¬ ν…μ¤νΈ
    async_start = time.time()
    async_tasks = [async_client_task(i+1) for i in range(3)]
    async_results = await asyncio.gather(*async_tasks)
    async_end = time.time()
    async_elapsed = async_end - async_start
    
    print(f"\nλΉ„λ™κΈ° λ„κµ¬ ν…μ¤νΈ μ™„λ£! μ΄ μ†μ”μ‹κ°„: {async_elapsed:.2f}μ΄")
    
    # κ²°κ³Ό μ”μ•½
    print("\n" + "="*60)
    print("ν…μ¤νΈ κ²°κ³Ό μ”μ•½")
    print("="*60)
    print(f"λ™κΈ° λ„κµ¬ μ†μ”μ‹κ°„: {sync_elapsed:.2f}μ΄")
    print(f"λΉ„λ™κΈ° λ„κµ¬ μ†μ”μ‹κ°„: {async_elapsed:.2f}μ΄")
    print(f"μ„±λ¥ μ°¨μ΄: {abs(sync_elapsed - async_elapsed):.2f}μ΄")
    print("ν…μ¤νΈ μ™„λ£!")
```
- 3κ°μ λ™μ‹ ν΄λΌμ΄μ–ΈνΈλ΅ λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬λ¥Ό κ°κ° ν…μ¤νΈ
- `asyncio.gather()`λ¥Ό μ‚¬μ©ν•μ—¬ λ™μ‹ μ‹¤ν–‰ν•λ μ‹¤μ  μ„λ²„ μ²λ¦¬ λ°©μ‹μ— λ”°λ¥Έ μ„±λ¥ μ°¨μ΄ μΈ΅μ •
- μ „μ²΄ μ†μ”μ‹κ°„κ³Ό μ„±λ¥ μ°¨μ΄λ¥Ό μ •λ‰μ μΌλ΅ λΉ„κµν•μ—¬ κ²°κ³Ό μ¶λ ¥

## π€ μ‹¤ν–‰

### μ‚¬μ „ μ”κµ¬μ‚¬ν•­

1. **Python ν¨ν‚¤μ§€ μ„¤μΉ**
```bash
pip install fastmcp anyio
```

2. **Python λ²„μ „ ν™•μΈ**
- Python 3.8 μ΄μƒ ν•„μ” (asyncio, anyio μ§€μ›)

### μ‹¤ν–‰ λ°©λ²•

1. **MCP μ„λ²„ μ‹¤ν–‰**
```bash
python server.py
```

2. **μƒλ΅μ΄ ν„°λ―Έλ„μ—μ„ ν΄λΌμ΄μ–ΈνΈ ν…μ¤νΈ μ‹¤ν–‰**
```bash
python client.py
```

### μ‹¤ν–‰ κ²°κ³Ό

μ„λ²„λ¥Ό μ‹¤ν–‰ν•λ©΄ λ‹¤μκ³Ό κ°™μ€ λ©”μ‹μ§€κ°€ μ¶λ ¥λ©λ‹λ‹¤:

```bash
FastMCP server running on http://0.0.0.0:9000
```

ν΄λΌμ΄μ–ΈνΈλ¥Ό μ‹¤ν–‰ν•λ©΄ λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬μ μ„±λ¥ μ°¨μ΄λ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤:

```bash
λ™κΈ°/λΉ„λ™κΈ° λ„κµ¬ μ„±λ¥ λΉ„κµ ν…μ¤νΈλ¥Ό μ‹μ‘ν•©λ‹λ‹¤...

==================================================
λ™κΈ° λ„κµ¬ ν…μ¤νΈ μ‹μ‘
==================================================
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 1: μ‹μ‘
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 2: μ‹μ‘
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 3: μ‹μ‘
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 1: μ™„λ£ - μ†μ”μ‹κ°„: 1.02μ΄
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 1: κ²°κ³Ό - 1μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 2: μ™„λ£ - μ†μ”μ‹κ°„: 2.03μ΄
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 2: κ²°κ³Ό - 1μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 3: μ™„λ£ - μ†μ”μ‹κ°„: 3.04μ΄
λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 3: κ²°κ³Ό - 1μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.

λ™κΈ° λ„κµ¬ ν…μ¤νΈ μ™„λ£! μ΄ μ†μ”μ‹κ°„: 3.04μ΄

==================================================
λΉ„λ™κΈ° λ„κµ¬ ν…μ¤νΈ μ‹μ‘
==================================================
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 1: μ‹μ‘
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 2: μ‹μ‘
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 3: μ‹μ‘
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 1: μ™„λ£ - μ†μ”μ‹κ°„: 1.01μ΄
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 1: κ²°κ³Ό - 1μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 2: μ™„λ£ - μ†μ”μ‹κ°„: 1.01μ΄
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 2: κ²°κ³Ό - 1μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 3: μ™„λ£ - μ†μ”μ‹κ°„: 1.01μ΄
λΉ„λ™κΈ° ν΄λΌμ΄μ–ΈνΈ 3: κ²°κ³Ό - 1μ΄ λ™μ• CPU μ§‘μ•½μ  μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.

λΉ„λ™κΈ° λ„κµ¬ ν…μ¤νΈ μ™„λ£! μ΄ μ†μ”μ‹κ°„: 1.01μ΄

============================================================
ν…μ¤νΈ κ²°κ³Ό μ”μ•½
============================================================
λ™κΈ° λ„κµ¬ μ†μ”μ‹κ°„: 3.04μ΄
λΉ„λ™κΈ° λ„κµ¬ μ†μ”μ‹κ°„: 1.01μ΄
μ„±λ¥ μ°¨μ΄: 2.03μ΄
ν…μ¤νΈ μ™„λ£!
```

μ„ μ‹¤ν–‰ κ²°κ³Όμ—μ„ ν™•μΈν•  μ μλ“―μ΄, λ™κΈ° λ„κµ¬λ” κ° μ”μ²­μ΄ μμ°¨μ μΌλ΅ μ²λ¦¬λμ–΄ μ΄ 3μ΄ μ΄μƒμ΄ μ†μ”λλ” λ°λ©΄, λΉ„λ™κΈ° λ„κµ¬λ” λ¨λ“  μ”μ²­μ΄ λ™μ‹μ— μ²λ¦¬λμ–΄ μ•½ 1μ΄λ§ μ†μ”λ©λ‹λ‹¤. μ΄λ” λΉ„λ™κΈ° ν”„λ΅κ·Έλλ°μ΄ I/O μ§‘μ•½μ μ΄κ±°λ‚ λ€κΈ° μ‹κ°„μ΄ μλ” μ‘μ—…μ—μ„ μ–Όλ§λ‚ ν¨κ³Όμ μΈμ§€λ¥Ό λ…ν™•ν•κ² λ³΄μ—¬μ¤λ‹λ‹¤.

## π“ μ •λ¦¬

μ΄ μμ λ” FastMCP ν™κ²½μ—μ„ λ™κΈ°μ™€ λΉ„λ™κΈ° λ„κµ¬μ μ„±λ¥ μ°¨μ΄λ¥Ό μ‹¤μ§μ μΌλ΅ μ²΄ν—ν•  μ μλ” μ‹¤μµ ν”„λ΅μ νΈμ…λ‹λ‹¤. λ™κΈ° λ°©μ‹μ `sync_tool()`μ€ μ΄λ²¤νΈ λ£¨ν”„λ¥Ό λΈ”λ΅ν•μ—¬ λ‹¤μ¤‘ μ”μ²­μ„ μμ°¨μ μΌλ΅ μ²λ¦¬ν•λ” λ°λ©΄, λΉ„λ™κΈ° λ°©μ‹μ `async_tool()`μ€ `anyio.to_thread.run_sync()`λ¥Ό ν™μ©ν•μ—¬ CPU μ§‘μ•½μ  μ‘μ—…μ„ λ³„λ„ μ¤λ λ“μ—μ„ μ‹¤ν–‰ν•¨μΌλ΅μ¨ μ΄λ²¤νΈ λ£¨ν”„ λΈ”λ΅ν‚Ήμ„ λ°©μ§€ν•©λ‹λ‹¤. 3κ°μ λ™μ‹ ν΄λΌμ΄μ–ΈνΈλ΅ ν…μ¤νΈν• κ²°κ³Ό, λ™κΈ° λ„κµ¬λ” μ•½ 3μ΄, λΉ„λ™κΈ° λ„κµ¬λ” μ•½ 1μ΄κ°€ μ†μ”λμ–΄ μ•½ 3λ°°μ μ„±λ¥ μ°¨μ΄λ¥Ό ν™•μΈν•  μ μμ—μµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ MCP μ„λ²„ κ°λ° μ‹ μ μ ν• λΉ„λ™κΈ° ν¨ν„΄ μ μ©μ μ¤‘μ”μ„±κ³Ό `anyio.to_thread` κ°™μ€ λ„κµ¬λ¥Ό ν™μ©ν• λΈ”λ΅ν‚Ή λ°©μ§€ κΈ°λ²•μ μ‹¤μ©μ  κ°€μΉλ¥Ό ν•™μµν•  μ μμµλ‹λ‹¤. νΉν λ‹¤μ¤‘ μ‚¬μ©μ ν™κ²½μ΄λ‚ λ†’μ€ λ™μ‹μ„±μ΄ μ”κµ¬λλ” MCP μ• ν”λ¦¬μΌ€μ΄μ…μ—μ„λ” μ΄λ¬ν• λΉ„λ™κΈ° μ²λ¦¬ λ°©μ‹μ΄ ν•„μμ μ„μ„ μ‹¤μ¦μ μΌλ΅ λ³΄μ—¬μ£Όλ” μ¤‘μ”ν• μμ μ…λ‹λ‹¤.